
<ng-container ng-if="vm.isFieldVisible('shortDescription')">
    <label for="shortDescription">
        Short description
        <span class="max-length">({{ vm.remaining(vm.profile.shortDescription.value, 1100) }} characters remaining)</span>
    </label>
    <ul class="enable-listing">
        <li>
            <scientilla-privacy-selector
                context-string="shortDescription"
                profile="vm.profile"
                errors="vm.profile.shortDescription.errors.privacy"
                model="vm.profile.shortDescription.privacy"
                disabled="vm.disabled"
            ></scientilla-privacy-selector>
        </li>
        <li>
            <div
                class="form-group"
                ng-class="{'has-error': vm.profile.shortDescription.errors.value}">
                <textarea
                    name="shortDescription"
                    id="shortDescription"
                    class="form-control"
                    cols="30"
                    rows="10"
                    ng-model="vm.profile.shortDescription.value"
                    ng-class="{
                        'is-invalid': vm.profile.shortDescription.errors.value
                    }"
                    ng-disabled="vm.disabled"
                ></textarea>
                <scientilla-field-errors
                    errors="vm.profile.shortDescription.errors.value"></scientilla-field-errors>
            </div>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('achievements')">
    <label for="achievements">
        Achievements
        <span class="max-length">({{ vm.remaining(vm.profile.achievements.value, 700) }} characters remaining)</span>
    </label>
    <ul class="enable-listing">
        <li>
            <scientilla-privacy-selector
                context-string="achievements"
                profile="vm.profile"
                errors="vm.profile.achievements.errors.privacy"
                model="vm.profile.achievements.privacy"
                disabled="vm.disabled"
            ></scientilla-privacy-selector>
        </li>
        <li>
            <div
                class="form-group"
                ng-class="{'has-error': vm.profile.achievements.errors.value}">
                <textarea
                    name="achievements"
                    id="achievements"
                    class="form-control"
                    cols="30"
                    rows="10"
                    ng-model="vm.profile.achievements.value"
                    ng-class="{
                        'is-invalid': vm.profile.achievements.errors.value
                    }"
                    ng-disabled="vm.disabled"
                ></textarea>
                <scientilla-field-errors
                    errors="vm.profile.achievements.errors.value"></scientilla-field-errors>
            </div>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('description')">
    <label for="description">Description</label>
    <ul class="enable-listing">
        <li>
            <scientilla-privacy-selector
                context-string="description"
                profile="vm.profile"
                errors="vm.profile.description.errors.privacy"
                model="vm.profile.description.privacy"
                disabled="vm.disabled"
            ></scientilla-privacy-selector>
        </li>
        <li>
            <div
                class="form-group"
                ng-class="{'has-error': vm.profile.description.errors.value}">
                <text-angular
                    name="description"
                    id="description"
                    cols="30"
                    rows="10"
                    ng-model="vm.profile.description.value"
                    ng-class="{
                        'is-invalid': vm.profile.description.errors.value,
                        'is-invisible' : vm.profile.description.privacy === 'invisible'
                    }"
                    ta-paste="vm.format($html)"
                    ta-disabled="vm.disabled"
                ></text-angular>
                <scientilla-field-errors
                    errors="vm.profile.description.errors.value"></scientilla-field-errors>
            </div>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('collaborations')">
    <label for="collaborations">Collaborations</label>
    <ul class="enable-listing">
        <li>
            <scientilla-privacy-selector
                context-string="collaborations"
                profile="vm.profile"
                errors="vm.profile.collaborations.errors.privacy"
                model="vm.profile.collaborations.privacy"
                disabled="vm.disabled"
            ></scientilla-privacy-selector>
        </li>
        <li>
            <div
                class="form-group"
                ng-class="{'has-error': vm.profile.collaborations.errors.value}">
                <text-angular
                    name="collaborations"
                    id="collaborations"
                    cols="30"
                    rows="10"
                    ng-model="vm.profile.collaborations.value"
                    ng-class="{
                        'is-invalid': vm.profile.collaborations.errors.value,
                        'is-invisible' : vm.profile.collaborations.privacy === 'invisible'
                    }"
                    ta-paste="vm.format($html)"
                    ta-disabled="vm.disabled"
                ></text-angular>
                <scientilla-field-errors
                    errors="vm.profile.collaborations.errors.value"></scientilla-field-errors>
            </div>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('laboratories')">
    <label for="laboratories">Laboratories</label>
    <ul class="enable-listing">
        <li>
            <scientilla-privacy-selector
                context-string="laboratories"
                profile="vm.profile"
                errors="vm.profile.laboratories.errors.privacy"
                model="vm.profile.laboratories.privacy"
                disabled="vm.disabled"
            ></scientilla-privacy-selector>
        </li>
        <li>
            <div
                class="form-group"
                ng-class="{'has-error': vm.profile.laboratories.errors.value}">
                <text-angular
                    name="laboratories"
                    id="laboratories"
                    cols="30"
                    rows="10"
                    ng-model="vm.profile.laboratories.value"
                    ng-class="{
                        'is-invalid': vm.profile.laboratories.errors.value,
                        'is-invisible' : vm.profile.laboratories.privacy === 'invisible'
                    }"
                    ta-paste="vm.format($html)"
                    ta-disabled="vm.disabled"
                ></text-angular>
                <scientilla-field-errors
                    errors="vm.profile.laboratories.errors.value"></scientilla-field-errors>
            </div>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('url')">
    <label for="url">URL</label>
    <ul class="enable-listing">
        <li>
            <scientilla-privacy-selector
                context-string="url"
                profile="vm.profile"
                errors="vm.profile.url.errors.privacy"
                model="vm.profile.url.privacy"
                disabled="vm.disabled"
            ></scientilla-privacy-selector>
        </li>
        <li>
            <div
                class="form-group"
                ng-class="{'has-error': vm.profile.url.errors.value}"
            >
                <input
                    type="text"
                    class="form-control"
                    id="url"
                    placeholder="URL"
                    ng-model="vm.profile.url.value"
                    ng-class="{
                        'is-invalid': vm.profile.url.errors.value,
                        'is-invisible' : vm.profile.url.privacy === 'invisible'
                    }"
                    ng-disabled="vm.disabled"
                />
                <scientilla-field-errors
                    errors="vm.profile.url.errors.value"></scientilla-field-errors>
            </div>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('topics')">
    <label class="label-topic">Topics</label>
    <ul class="item-listing topic-listing" ui-sortable="vm.options" ng-model="vm.profile.topics">
        <li ng-repeat="(key, topic) in vm.profile.topics track by $index">
            <ul class="enable-listing no-labels">
                <li>
                    <scientilla-privacy-selector
                        context-string="topics[{{ key }}]"
                        model="vm.profile.topics[key].privacy"
                        errors="vm.profile.topics[key].errors.privacy"
                        profile="vm.profile"
                        disabled="vm.disabled"
                    ></scientilla-privacy-selector>
                </li>
                <li>
                    <ul class="field-listing">
                        <li>
                            <div
                                class="form-group"
                                ng-class="{'has-error': vm.profile.topics[key].errors.value}">
                                <input
                                    type="text"
                                    class="form-control"
                                    placeholder="Topic"
                                    ng-model="topic.value"
                                    ng-class="{
                                        'is-invalid': vm.profile.topics[key].errors.value,
                                        'is-invisible' : vm.profile.topics[key].privacy === 'invisible'
                                    }"
                                    ng-disabled="vm.disabled"
                                />
                                <scientilla-field-errors
                                    errors="vm.profile.topics[key].errors.value"></scientilla-field-errors>
                            </div>
                        </li>
                        <li class="desktop-actions">
                            <div class="form-group">
                                <button class="btn btn-outline-secondary" ng-disabled="vm.disabled">
                                    <i class="fas fa-arrows-alt"></i>
                                </button>
                            </div>
                        </li>
                        <li class="desktop-actions">
                            <div class="form-group">
                                <button
                                    class="btn btn-outline-secondary"
                                    ng-click="vm.removeItem({
                                        property: vm.profile.topics,
                                        index: key
                                    })"
                                    ng-disabled="vm.disabled"
                                >
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </li>
                        <li class="mobile-actions">
                            <ul>
                                <li>
                                    <div class="form-group">
                                        <button
                                            class="btn btn-outline-secondary"
                                            ng-class="{'disabled': $index === 0}"
                                            ng-disabled="$index === 0 || vm.disabled"
                                            ng-click="vm.moveUp('topics', key, topic)"
                                        >
                                            <i class="fas fa-arrow-up fa-left"></i>Move up
                                        </button>
                                    </div>
                                </li>
                                <li>
                                    <div class="form-group">
                                        <button
                                            class="btn btn-outline-secondary"
                                            ng-class="{'disabled': $index === vm.profile.topics.length -1}"
                                            ng-disabled="$index === vm.profile.topics.length -1 || vm.disabled"
                                            ng-click="vm.moveDown('topics', key, topic)"
                                        >
                                            <i class="fas fa-arrow-down fa-left"></i>Move down
                                        </button>
                                    </div>
                                </li>
                                <li>
                                    <div class="form-group">
                                        <button
                                            class="btn btn-outline-secondary"
                                            ng-click="vm.removeItem({
                                                property: vm.profile.topics,
                                                index: key
                                            })"
                                            ng-disabled="vm.disabled"
                                        >
                                            <i class="fas fa-trash fa-left"></i>Delete
                                        </button>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>

        <li>
            <button
                class="btn btn-link btn-inline"
                ng-click="vm.addItem({
                    property: vm.profile.topics
                })"
                ng-disabled="vm.disabled"
            >
                <i class="fas fa-plus fa-left"></i>Add topic
            </button>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('services')">
    <label class="label-service">Services</label>
    <ul class="item-listing service-listing" ui-sortable="vm.options" ng-model="vm.profile.services">
        <li ng-repeat="(key, service) in vm.profile.services track by $index">
            <ul class="enable-listing no-labels">
                <li>
                    <scientilla-privacy-selector
                        context-string="services[{{ key }}]"
                        model="vm.profile.services[key].privacy"
                        errors="vm.profile.services[key].errors.privacy"
                        profile="vm.profile"
                        disabled="vm.disabled"
                    ></scientilla-privacy-selector>
                </li>
                <li>
                    <ul class="field-listing">
                        <li>
                            <div
                                class="form-group"
                                ng-class="{'has-error': vm.profile.services[key].errors.value}">
                                <input
                                    type="text"
                                    class="form-control"
                                    placeholder="Service"
                                    ng-model="service.value"
                                    ng-class="{
                                        'is-invalid': vm.profile.services[key].errors.value,
                                        'is-invisible' : vm.profile.services[key].privacy === 'invisible'
                                    }"
                                    ng-disabled="vm.disabled"
                                />
                                <scientilla-field-errors
                                    errors="vm.profile.services[key].errors.value"></scientilla-field-errors>
                            </div>
                        </li>
                        <li class="desktop-actions">
                            <div class="form-group">
                                <button class="btn btn-outline-secondary" ng-disabled="vm.disabled">
                                    <i class="fas fa-arrows-alt"></i>
                                </button>
                            </div>
                        </li>
                        <li class="desktop-actions">
                            <div class="form-group">
                                <button
                                    class="btn btn-outline-secondary"
                                    ng-click="vm.removeItem({
                                        property: vm.profile.services,
                                        index: key
                                    })"
                                    ng-disabled="vm.disabled"
                                >
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </li>
                        <li class="mobile-actions">
                            <ul>
                                <li>
                                    <div class="form-group">
                                        <button
                                            class="btn btn-outline-secondary"
                                            ng-class="{'disabled': $index === 0}"
                                            ng-disabled="$index === 0 || vm.disabled"
                                            ng-click="vm.moveUp('services', key, service)"
                                        >
                                            <i class="fas fa-arrow-up fa-left"></i>Move up
                                        </button>
                                    </div>
                                </li>
                                <li>
                                    <div class="form-group">
                                        <button
                                            class="btn btn-outline-secondary"
                                            ng-class="{'disabled': $index === vm.profile.services.length -1}"
                                            ng-disabled="$index === vm.profile.services.length -1 || vm.disabled"
                                            ng-click="vm.moveDown('services', key, service)"
                                        >
                                            <i class="fas fa-arrow-down fa-left"></i>Move down
                                        </button>
                                    </div>
                                </li>
                                <li>
                                    <div class="form-group">
                                        <button
                                            class="btn btn-outline-secondary"
                                            ng-click="vm.removeItem({
                                                property: vm.profile.services,
                                                index: key
                                            })"
                                            ng-disabled="vm.disabled"
                                        >
                                            <i class="fas fa-trash fa-left"></i>Delete
                                        </button>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>

        <li>
            <button
                class="btn btn-link btn-inline"
                ng-click="vm.addItem({
                    item: { privacy: 'public'},
                    property: vm.profile.services
                })"
                ng-disabled="vm.disabled"
            >
                <i class="fas fa-plus fa-left"></i>Add service
            </button>
        </li>
    </ul>
</ng-container>

<ng-container ng-if="vm.isFieldVisible('coverImage')">
    <label for="image">Cover image</label>
    <ul class="enable-listing">
        <li>
            <scientilla-privacy-selector
                context-string="coverImage"
                model="vm.profile.coverImage.privacy"
                errors="vm.profile.coverImage.errors.privacy"
                profile="vm.profile"
                disabled="vm.disabled"
            ></scientilla-privacy-selector>
        </li>
        <li>
            <div
                class="form-group"
                ng-class="{'has-error': vm.profile.coverImage.errors.value}">
                <input
                    type="file"
                    class="form-control"
                    id="image"
                    placeholder="Cover image"
                    accept="image/png, image/jpeg"
                    ng-if="!vm.profile.coverImage.value"
                    ng-class="{
                        'is-invalid': vm.profile.coverImage.errors,
                        'is-invisible' : vm.profile.coverImage.privacy === 'invisible'
                    }"
                    valid-image
                    image="vm.image"
                    max-size="500"
                    min-width="750"
                    min-height="500"
                    image-error-message="vm.imageErrorMessage"
                    ng-disabled="vm.disabled"
                />
                <div
                    ng-if="vm.profile.coverImage.value"
                    class="image-container">
                    <img ng-src="{{ vm.pathProfileImages + vm.profile.coverImage.value }}" alt="" class="img-fluid cover-image">
                    <button
                        class="btn-remove-image"
                        ng-click="vm.profile.coverImage.value = vm.coverImage = ''"
                        ng-disabled="vm.disabled"
                    ><i class="fas fa-trash"></i></button>
                </div>
                <em
                    class="image-info"
                    ng-if="!vm.profile.coverImage.value"
                >We suggest to upload an image (JPG, JPEG or PNG) with the minimum resolution of 750px (width) by 500px (height) and a maximum file size of 500KB.</em>
                <scientilla-field-errors errors="vm.profile.coverImage.errors.value"></scientilla-field-errors>
            </div>
        </li>
    </ul>
</ng-container>